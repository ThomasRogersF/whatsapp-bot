name = "twilio-whatsapp-bot"
main = "src/index.ts"
compatibility_date = "2025-03-01"

# ─── KV Namespace ─────────────────────────────────────────────────────────────
# After running `wrangler kv:namespace create BOT_KV`, paste the returned id below.
# After running `wrangler kv:namespace create BOT_KV --preview`, paste the preview_id below.
[[kv_namespaces]]
binding = "BOT_KV"
id = "d0f883ea599f480d8b4c90849378d43a"
preview_id = "1c7c788345da4a19911f869d2211b58a"

# ─── Environment Variables ────────────────────────────────────────────────────
[vars]
# Minimum weekly hours threshold for Q2 part-time acceptance (default 15).
MIN_WEEKLY_HOURS = "15"

# Your Green-API instance ID (numeric string shown in the Green-API dashboard).
# Example: "1234567890"
GREENAPI_ID_INSTANCE = ""

# Link sent to candidates who PASS screening (wa.me deep-link to Maria).
MARIA_WA_ME_LINK = "https://wa.me/573022379539?text=Hi%20Maria%2C%20I%20passed%20screening%20and%20would%20like%20to%20schedule%20my%20interview."

# ─── Secrets ──────────────────────────────────────────────────────────────────
# The following values must be set as Cloudflare Worker secrets (never committed
# to source control). Run each command and paste the value when prompted:
#
#   wrangler secret put GREENAPI_API_TOKEN
#     -> Your Green-API API token (found in the Green-API dashboard for your instance).
#
#   wrangler secret put MAKE_WEBHOOK_URL          (optional)
#     -> The Make.com (or other) webhook URL to POST screening results to.
#        If unset, result POSTing is skipped and only the session is cleared.

# ─── Deployment Commands ──────────────────────────────────────────────────────
# 1. Authenticate:
#      wrangler login
#
# 2. Create KV namespace (production):
#      wrangler kv:namespace create BOT_KV
#      -> Copy the printed id into [[kv_namespaces]] id above
#
# 3. Create KV namespace (local dev / preview):
#      wrangler kv:namespace create BOT_KV --preview
#      -> Copy the printed id into [[kv_namespaces]] preview_id above
#
# 4. Set required secrets:
#      wrangler secret put GREENAPI_API_TOKEN
#
# 5. Set optional secrets:
#      wrangler secret put MAKE_WEBHOOK_URL
#
# 6. Update vars above (GREENAPI_ID_INSTANCE, MARIA_WA_ME_LINK) with real values.
#
# 7. Deploy:
#      wrangler deploy
#
# 8. View live logs:
#      wrangler tail
#
# 9. Local development server:
#      wrangler dev
#
# After deploying, configure the Green-API webhook:
#   Green-API dashboard → your instance → Settings → Webhook settings
#   Set "Webhook URL" to:
#     https://twilio-whatsapp-bot.<your-account>.workers.dev/greenapi/webhook
#   Enable "Incoming messages" notifications.
#   Save and make sure the instance is connected (QR code scanned).
